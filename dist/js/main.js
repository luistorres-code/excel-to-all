const $$=e=>document.getElementById(e),homePage=$$("homePage"),toExcelPage=$$("toExcelPage"),fromExcelPage=$$("fromExcelPage"),jsonViewerContainer=$$("jsonViewerContainer"),queryViewerContainer=$$("queryViewerContainer"),jsonViewer=$$("jsonViewer"),queryViewer=$$("queryViewer"),selectedInput=$$("file"),optionsInput=$$("options"),tableNameInput=$$("tableName"),sendExcelButton=$$("sendExcel"),fileInputContainer=$$("fileInputContainer"),tableNameCOntainer=$$("tableNameContainer"),copyJSONButton=$$("copyJSONButton"),copySQLButton=$$("copyQueryButton"),optionsToExcel=$$("optionsToExcel"),jsonInput=$$("jsonInput"),excelGenerateButton=$$("excelGenerateButton"),formtoExcelValidator=$$("formtoExcelValidator");function pageNavigator(){var e=window.location.hash;"#toExcel"===e?toExcelPage.classList.contains("hidden")&&(toExcelPage.classList.remove("hidden"),toExcelPage.classList.add("flex","flex-col","flex-wrap"),homePage.classList.add("hidden"),fromExcelPage.classList.add("hidden")):"#fromExcel"===e?fromExcelPage.classList.contains("hidden")&&(fromExcelPage.classList.remove("hidden"),fromExcelPage.classList.add("flex","flex-wrap"),homePage.classList.add("hidden"),toExcelPage.classList.add("hidden")):"#home"===e&&(history.pushState("",document.title,window.location.pathname),location.reload())}function convertExcelToJSON(){var e=selectedInput.files[0],t=new FileReader;const n=optionsInput.value,o=tableNameInput.value;t.onload=function(e){e=new Uint8Array(e.target.result);const t=XLSX.read(e,{type:"array"});e=t.SheetNames.map(function(e){e=t.Sheets[e];return XLSX.utils.sheet_to_json(e)});"all"!==n&&"json"!==n||(copyJSONButton.classList.remove("hidden"),jsonViewerContainer.classList.add("hidden"),jsonViewer.classList.add("hljs"),jsonViewer.innerHTML=JSON.stringify(e[0],null,2),hljs.highlightElement(jsonViewer),jsonViewerContainer.classList.contains("hidden")&&jsonViewerContainer.classList.remove("hidden")),"all"!==n&&"query"!==n||(copySQLButton.classList.remove("hidden"),queryViewerContainer.classList.add("hidden"),createSQLQueryFromJSON(e[0],o||"table_name"),queryViewerContainer.classList.contains("hidden")&&queryViewerContainer.classList.remove("hidden")),"query"!==n||jsonViewerContainer.classList.contains("hidden")||(jsonViewerContainer.classList.add("hidden"),copyJSONButton.classList.add("hidden")),"json"!==n||queryViewerContainer.classList.contains("hidden")||(queryViewerContainer.classList.add("hidden"),copySQLButton.classList.add("hidden"))},t.readAsArrayBuffer(e)}function downloadJSONFile(e){var e="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(e)),t=document.createElement("a");t.setAttribute("href",e),t.setAttribute("download","data.json"),document.body.appendChild(t),t.click(),t.remove()}function createSQLQueryFromJSON(e,t){t=`INSERT INTO ${t} (${Object.keys(e[0]).join(", ")}) 
 VALUES ${e.map(e=>`
 (${Object.values(e).map(e=>"number"==typeof e||"boolean"==typeof e?e:`'${e}'`).join(", ")})`).join(", ")};`;queryViewer.innerHTML=t,hljs.highlightElement(queryViewer)}function copyToClipboard(e,t){var n=window.navigator.clipboard;const o=e.textContent;n.writeText(t.textContent).then(function(){e.textContent="Copiado!",setTimeout(()=>{e.textContent=o},500)},function(e){console.error("Async: Could not copy text: ",e)})}function convertJSONToExcel(){var t=jsonInput.value,n=optionsToExcel.value;if(formtoExcelValidator.textContent="",formtoExcelValidator.classList.add("hidden"),console.log("run"),t&&n&&""!==t&&""!==n){let e;try{e=JSON.parse(t)}catch(e){return formtoExcelValidator.classList.remove("hidden"),void(formtoExcelValidator.textContent="El JSON no es vÃ¡lido")}"csv"===n?(console.log("csv"),t=XLSX.utils.sheet_to_csv(XLSX.utils.json_to_sheet(e)),n=new Blob([t],{type:"text/csv;charset=utf-8;"}),t=window.URL.createObjectURL(n),(n=document.createElement("a")).setAttribute("href",t),n.setAttribute("download","data.csv"),document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(t)):(console.log("excel"),n=XLSX.utils.json_to_sheet(e),t=XLSX.utils.book_new(),XLSX.utils.book_append_sheet(t,n,"Hoja 1"),XLSX.writeFile(t,"data.xlsx")),jsonInput.value=""}else formtoExcelValidator.classList.remove("hidden"),formtoExcelValidator.textContent="Hay campos sin llenar"}sendExcelButton.addEventListener("click",convertExcelToJSON),copyJSONButton.addEventListener("click",()=>copyToClipboard(copyJSONButton,jsonViewer)),copySQLButton.addEventListener("click",()=>copyToClipboard(copySQLButton,queryViewer)),optionsInput.addEventListener("change",e=>{fileInputContainer.classList.contains("hidden")&&(fileInputContainer.classList.remove("hidden"),fileInputContainer.classList.add("flex","flex-col")),fileInputContainer.hasAttribute("required")||selectedInput.setAttribute("required",!0);e=e.target.value;"all"!==e&&"query"!==e||!tableNameCOntainer.classList.contains("hidden")?tableNameCOntainer.hasAttribute("required")&&(tableNameCOntainer.classList.add("hidden"),tableNameCOntainer.classList.remove("flex","flex-col"),tableNameCOntainer.removeAttribute("required")):(tableNameCOntainer.classList.remove("hidden"),tableNameCOntainer.classList.add("flex","flex-col"),tableNameCOntainer.setAttribute("required",!0)),sendExcelButton.classList.contains("hidden")&&sendExcelButton.classList.remove("hidden")}),excelGenerateButton.addEventListener("click",e=>{e.preventDefault(),convertJSONToExcel()}),window.addEventListener("hashchange",pageNavigator,!1),window.addEventListener("DOMContentLoaded",pageNavigator,!1);